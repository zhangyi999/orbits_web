(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05e8efc1"],{"15a2":function(t,e,n){t.exports=n.p+"static/img/swap-change.5059e922.svg"},"204c":function(t,e,n){"use strict";n("7910")},"2a7d":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{class:(t.disabled?"disabled ":"")+(t.loading?"loading ":"")+"focus:outline-none text-lg py-3 text-white-100 bg-gradient-to-r w-full rounded-full from-main-700 to-main-500",on:{click:t.click}},[t._t("default")],2)},o=[],a={name:"Button",props:{disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},click:{type:Function,default:function(){}}}},s=a,i=(n("ce2b"),n("2877")),c=Object(i["a"])(s,r,o,!1,null,"dcc9a3a6",null);e["a"]=c.exports},"34b3":function(t,e,n){},3835:function(t,e,n){"use strict";function r(t){if(Array.isArray(t))return t}n.d(e,"a",(function(){return i}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function o(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,o=!1,a=void 0;try{for(var s,i=t[Symbol.iterator]();!(r=(s=i.next()).done);r=!0)if(n.push(s.value),e&&n.length===e)break}catch(c){o=!0,a=c}finally{try{r||null==i["return"]||i["return"]()}finally{if(o)throw a}}return n}}var a=n("06c5");function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t,e){return r(t)||o(t,e)||Object(a["a"])(t,e)||s()}},"6c6a":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"swap"},[r("div",{staticClass:"mx-auto bg-card p-6 rounded-2xl text-white-45",staticStyle:{"max-width":"504px",width:"100%"}},[r("div",{staticClass:"text-white-100 text-3xl mb-10"},[t._v(t._s(t.$t("swap.title")))]),r("div",{staticClass:"rounded-2xl border border-white-15 border-solid p-4 hover:border-white-30"},[r("div",{staticClass:"flex justify-between mb-5 items-center"},[r("div",{staticClass:"text-white-100 text-sm"},[t._v(t._s(t.$t("swap.from")))]),r("div",{staticClass:"text-xs text-main-400 cursor-pointer",on:{click:t.handleMax}},[t._v(" Max:"+t._s(t.form.from.max)+" ")])]),r("div",{staticClass:"flex justify-between mb-4 items-center"},[r("div",{staticClass:"w-2/3"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.from.num,expression:"form.from.num"}],staticClass:"block appearance-none border-0 focus:outline-none bg-white-none focus:border-0 px-3 w-full text-3xl placeholder-white-30 text-white-85",attrs:{type:"text",placeholder:"0.00"},domProps:{value:t.form.from.num},on:{input:[function(e){e.target.composing||t.$set(t.form.from,"num",e.target.value)},function(e){return t.handleInputNum(e,"from")}]}})]),r("div",{staticClass:"px-4 border-l border-solid border-white-15 cursor-pointer",on:{click:function(e){return t.chooseTokens("from")}}},[r("div",{staticClass:"text-base text-white-65 text-center"},[r("img",{staticClass:"inline-block w-5",attrs:{src:t.poolsUrl(t.form.from.name),alt:"",srcset:""}}),t._v(" "+t._s(t.form.from.name)+" "),r("img",{staticClass:"inline-block",attrs:{src:n("b4c8"),alt:"",srcset:""}})])])])]),r("div",{staticClass:"py-6 text-center"},[r("img",{staticClass:"inline-block cursor-pointer",attrs:{src:n("15a2"),alt:"",srcset:""},on:{click:t.handleExchange}})]),r("div",{staticClass:"rounded-2xl border border-white-15 border-solid p-4 hover:border-white-30"},[r("div",{staticClass:"flex justify-between mb-5 items-center"},[r("div",{staticClass:"text-white-100 text-sm"},[t._v(t._s(t.$t("swap.to")))])]),r("div",{staticClass:"flex justify-between mb-4 items-center"},[r("div",{staticClass:"w-2/3"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.to.num,expression:"form.to.num"}],staticClass:"block appearance-none border-0 focus:outline-none bg-white-none focus:border-0 px-3 w-full text-3xl placeholder-white-30 text-white-85",attrs:{type:"number",placeholder:"0.00",disabled:""},domProps:{value:t.form.to.num},on:{input:function(e){e.target.composing||t.$set(t.form.to,"num",e.target.value)}}})]),r("div",{staticClass:"px-4 border-l border-solid border-white-15 cursor-pointer",on:{click:function(e){return t.chooseTokens("to")}}},[r("div",{staticClass:"text-base text-white-65 text-center"},[r("img",{staticClass:"inline-block w-5",attrs:{src:t.poolsUrl(t.form.to.name),alt:"",srcset:""}}),t._v(" "+t._s(t.form.to.name)+" "),r("img",{staticClass:"inline-block",attrs:{src:n("b4c8"),alt:"",srcset:""}})])])])]),r("div",{staticClass:"text_title"},[t._v(" Exchange rate "),r("span",{staticStyle:{color:"#fff"}},[t._v(t._s(t.reta.from)+"/"+t._s(t.reta.to))]),t._v(" (including fees) "),r("span",{staticClass:"text-main-400"},[t._v(t._s(t.reta.value))])]),r("div",{staticClass:"text_title"},[t._v("Trade routed through: "),r("span",{staticClass:"text-main-400"},[t._v(t._s(t.reta.pool))])]),r("div",{staticClass:"mt-12 mb-3"},[t.account&&t.account.isMetaMaskConnected?r("div",{},[r("Button",{attrs:{disabled:t.disabled,loading:t.isLoading,click:t.handleApprove}},[t._v(" "+t._s(t.buttonText)+" ")]),r("div",{staticClass:"mt-8"},[r("div",{staticClass:"text-base text-white-65 flex justify-between items-center"},[r("div",[t._v("Max Slippage")]),r("div",{staticClass:"inline-block"},t._l(t.slippageList,(function(e,n){return r("span",{key:n,staticClass:"relative slippage h-10 leading-10 text-sm px-8 bg-white-04 text-white-100 rounded-full cursor-pointer inline-block mr-2 hover:bg-main-400",class:t.slippage===e?"active":"",on:{click:function(n){return t.handleSlip(e)}}},[t._v(t._s(e))])})),0),r("div",{staticClass:"inline-flex relative rounded-full border border-white-15 h-10 leading-10 w-20 mx-2"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.slippage,expression:"slippage"}],staticClass:"block appearance-none h-full border-0 focus:outline-none bg-white-none focus:border-0 px-3 w-full text-base placeholder-white-30 text-white-85",attrs:{type:"number",placeholder:"1"},domProps:{value:t.slippage},on:{input:function(e){e.target.composing||(t.slippage=e.target.value)}}}),r("span",{staticClass:"absolute top-0 right-2"},[t._v("%")])])])])],1):r("button",{staticClass:"focus:outline-none text-lg py-3 text-white-100 bg-gradient-to-r w-full rounded-full from-main-700 to-main-500",on:{click:t.handleConnect}},[t._v(" Unlock Wallet ")])])]),r("token-modal",{attrs:{show:t.showModal,coin:t.modalCoin},on:{"on-close":t.handleCloseTokens,"on-select":t.handleChooseToken}}),r("c-Notice",{model:{value:t.error,callback:function(e){t.error=e},expression:"error"}},[t._v(" "+t._s(t.errorText)+" ")])],1)},o=[],a=n("3835"),s=n("1da1"),i=n("5530"),c=(n("96cf"),n("b0c0"),n("b680"),n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("901e")),u=n.n(c),l=n("2f62"),m=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.show?r("div",{staticClass:"fixed top-0 left-0 right-0 bottom-0 w-full h-full z-50 bg-dark06"},[r("div",{staticClass:"token-box bg-cardDark100 p-5 rounded-2xl absolute top-1/2 left-1/2"},[r("div",{staticClass:"text-2xl mt-8 text-white-85 flex justify-between items-center"},[r("div",[t._v("Select Token")]),r("div",[r("img",{staticClass:"inline-block w-7 cursor-pointer",attrs:{src:n("bbbe"),alt:"",srcset:""},on:{click:t.handleClose}})])]),r("div",{staticClass:" mt-10 py-6"},[r("div",{staticClass:"text-white-85 text-base"},[t._v("Toekn List")]),r("div",{staticClass:"tokens mt-4"},t._l(t.tokensList,(function(e,n){return r("div",{key:n,staticClass:"h-14 token-list leading-14 rounded-full mt-4 border border-white-15 px-5 text-base text-white-85 hover:border-main-400 cursor-pointer",class:t.coin==e.name?"disable":"",on:{click:function(n){return t.handleSelect(e)}}},[r("img",{staticClass:"inline-block mr-3 w-6",attrs:{src:t.poolsUrl(e.name),alt:"",srcset:""}}),t._v(" "+t._s(e.name)+" ")])})),0)])])]):t._e()},d=[],f=n("a525"),p={props:{show:Boolean,coin:String},data:function(){return{tokensList:f["h"]}},methods:{poolsUrl:function(t){return n("f613")("./".concat(t,".png"))},handleClose:function(){this.$emit("on-close")},handleSelect:function(t){this.address!==t.address&&this.$emit("on-select",t)}}},h=p,b=(n("7877"),n("2877")),x=Object(b["a"])(h,m,d,!1,null,"bd09d7b6",null),v=x.exports,w=n("2a7d"),g=n("5991"),k=n("86d5"),C=n("b893"),_=[{name:"3pool",contract:g["h"]},{name:"hpt",contract:g["f"]},{name:"filda",contract:g["e"]},{name:"channels",contract:g["a"]}],y={name:"swap",components:{TokenModal:v,Button:w["a"]},data:function(){return{error:!1,errorText:"",form:{from:{name:"HUSD",address:"0x0298c2b32eae4da002a15f36fdf7615bea3da047",num:null,max:"0.00"},to:{name:"USDC",num:null,address:"0x9362bbef4b8313a8aa9f0c9808b80577aa26b73b",max:"0.00"}},chooseType:"from",showModal:!1,modalCoin:"HUSD",slippage:null,slippageList:["0.1","0.2"],orginFromMax:null,inputFoucs:"",orginToNum:0,orginFromNum:0,isLoading:!1,disabled:!1,buttonText:"Execute Swap",toMax:0,checked:!0,reta:{from:"HUSD",to:"USDC",value:"--",pool:"--"},contractId:-1}},computed:Object(i["a"])({},Object(l["b"])({account:"account",slip:"slip"})),methods:{swapContract:function(){return _[this.contractId].contract()},swapName:function(){return-1===this.contractId?"--":_[this.contractId].name},init:function(){this.reta.from=this.form.from.name,this.reta.to=this.form.to.name},setReteValue:function(){if(this.reta.from===this.form.to.name){if(1*this.form.from.num===0)return this.reta.value="--";this.reta.value=(this.form.to.num/this.form.from.num).toFixed(4)}else{if(1*this.form.to.num===0)return this.reta.value="--";this.reta.value=(this.form.from.num/this.form.to.num).toFixed(4)}},getBalanceOf:function(t,e){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var o,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=Object(g["b"])(t),r.next=3,o.methods.balanceOf(n.account.currentAccount).call();case 3:a=r.sent,"from"===e?n.orginFromMax=a:"to"===e&&(n.orginToMax=a),n.form[e].max=a/Object(C["a"])(t);case 6:case"end":return r.stop()}}),r)})))()},handleSlip:function(t){this.$store.dispatch("app/setSlip",t),this.slippage=t},handleMax:function(){this.form.from.num=this.form.from.max,this.getDy(this.form.from.max,"from",!0)},checkInput:function(){var t=this.form.from.num;return!isNaN(1*t)&&(1*t===0?(this.form.to.num="",!1):void(this.form.from.num=1*new u.a(this.form.from.num).toFixed(Object(C["b"])(this.form.from.name).decimals)))},setButtonStatus:function(){if(this.form.from.num>this.form.from.max)return this.disabled=!0,void(this.buttonText="Insufficient ".concat(this.form.from.name," balance"));this.disabled=!1,this.buttonText="Execute Swap"},handleInputNum:Object(C["c"])((function(){!1!==this.checkInput()&&(this.setButtonStatus(),this.setToNum())}),340),setToNum:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.init(),e.next=3,t.get_maxDy();case 3:t.reta.pool=t.swapName(),t.setReteValue();case 5:case"end":return e.stop()}}),e)})))()},getPoolMax:function(t,e){return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",0);case 1:case"end":return t.stop()}}),t)})))()},get_maxDy:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r,o,i,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.contractId=-1,n=new u.a(t.form.from.num).multipliedBy(Object(C["a"])(t.form.from.name)).toFixed(0),r=Object(C["a"])(t.form.to.name),o=0,i=-1,e.next=7,Promise.all(_.map(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(r,s){var c,u,l,m,d,f,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=r.contract,r.name,e.prev=1,u=c(),l=k["c"][s].currencyId[t.form.from.name.toLowerCase()],m=k["c"][s].currencyId[t.form.to.name.toLowerCase()],e.next=7,Promise.all([u.methods.get_dy_underlying(l,m,n).call(),t.getPoolMax(u._address,t.form.to.name)]);case 7:return d=e.sent,f=Object(a["a"])(d,2),p=f[0],f[1],1*p>o&&(o=1*p,i=s),e.abrupt("return",p);case 15:return e.prev=15,e.t0=e["catch"](1),console.log(e.t0,"error"),e.abrupt("return",0);case 19:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t,n){return e.apply(this,arguments)}}()));case 7:if(c=o/r,t.form.to.num=c,!(.7*t.form.from.num>c)){e.next=15;break}return t.disabled=!0,t.buttonText="Insufficient liquidity for this trade",e.abrupt("return",c);case 15:t.contractId=i;case 16:if(!(t.form.from.num>t.form.from.max)){e.next=20;break}return t.disabled=!0,t.buttonText="Insufficient ".concat(t.form.from.name," balance"),e.abrupt("return",c);case 20:if(!(c>0)){e.next=24;break}return t.disabled=!1,t.buttonText="Execute Swap",e.abrupt("return",c);case 24:return e.abrupt("return",c);case 25:case"end":return e.stop()}}),e)})))()},handleExchange:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(C["d"])(t.form),n.to.num=n.from.num,n.from.num="",t.form.from=n.to,t.form.to=n.from,e.next=7,t.setToNum();case 7:return e.abrupt("return");case 8:case"end":return e.stop()}}),e)})))()},handleConnect:function(){this.$store.dispatch("web3/registerWeb3")},poolsUrl:function(t){return n("f613")("./".concat(t,".png"))},handleCloseTokens:function(){this.showModal=!1},chooseTokens:function(t){this.chooseType=t,this.modalCoin="from"===t?this.form.to.name:this.form.from.name,this.showModal=!0},showError:function(t){var e=this;this.error=!0,this.errorText=t,setTimeout((function(){e.error=!1,e.errorText=""}),1e3)},handleChooseToken:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=e.chooseType,e.form[r].address=t.address,e.form[r].name=t.name,e.reta[r]=t.name,e.getAccountToken("from"===r,"to"===r),e.showModal=!1,n.next=8,e.setToNum();case 8:e.init();case 9:case"end":return n.stop()}}),n)})))()},handleApprove:function(){var t=this.form,e=t.from,n=t.to;e.num&&n.num&&this.approveSwap(e.name,e.num)},approveSwap:function(t,e){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var o,a,s,i,c,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=new u.a(e).multipliedBy(Object(C["a"])(t)).toFixed(0),a=Object(g["b"])(t),n.isLoading=!0,n.buttonText="Swap...",r.next=6,Object(g["g"])(a.methods.approve(n.swapContract()._address,o),n.account.currentAccount);case 6:return s=r.sent,i=s.confirmation,r.next=10,i();case 10:c=r.sent,l=c.status,1===l?n.transformSwap(o):(n.isLoading=!1,n.buttonText="Execute Swap");case 13:case"end":return r.stop()}}),r)})))()},transformSwap:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,o,a,s,i,c,l,m,d,f,p,h,b;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=new u.a(e.form.to.num).multipliedBy(Object(C["a"])(e.form.to.name)).multipliedBy(1-e.slippage/100).toFixed(0),o=e.swapContract(),a=k["c"][e.contractId],s=a.currencyId[e.form.from.name.toLowerCase()],i=a.currencyId[e.form.to.name.toLowerCase()],n.next=7,Object(g["g"])(o.methods[a.exchange](s,i,t,r),e.account.currentAccount);case 7:return c=n.sent,l=c.confirmation,m=c.getHash,n.next=12,m();case 12:if(d=n.sent,f=d.status,p=d.data,e.isLoading=!1,e.buttonText="Execute Swap",0!==f){n.next=19;break}return n.abrupt("return",e.showError("Swap Cancel"));case 19:return n.next=21,l();case 21:h=n.sent,b=h.status,1===b?(e.getAccountToken(),e.showError(p+" Success")):p&&e.showError(p+" Fail");case 24:case"end":return n.stop()}}),n)})))()},getAccountToken:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.account.isMetaMaskConnected&&(t&&this.getBalanceOf(this.form.from.name,"from"),e&&this.getBalanceOf(this.form.to.name,"to"))},checkLP:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,r,o,s,i,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=Object(g["b"])(t.form.to.name),r=Object(g["b"])(t.form.from.name),o=t.swapContract()._address,e.prev=3,e.next=6,Promise.all([n.methods.balanceOf(o).call(),r.methods.balanceOf(o).call()]);case 6:s=e.sent,i=Object(a["a"])(s,2),c=i[0],u=i[1],t.toMax=c,0===t.toMax||1*u===0?(t.checked=!1,t.disabled=!0,t.buttonText="Insufficient liquidity for this trade"):(t.disabled=!1,t.checked=!0,t.buttonText="Execute Swap"),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](3),console.log({error:e.t0});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})))()}},mounted:function(){var t=this;this.$nextTick((function(){try{t.getAccountToken(),t.slippage=t.slip}catch(e){console.log(e)}}))}},T=y,j=(n("204c"),Object(b["a"])(T,r,o,!1,null,"2b0ada78",null));e["default"]=j.exports},7877:function(t,e,n){"use strict";n("9845")},7910:function(t,e,n){},9845:function(t,e,n){},b4c8:function(t,e,n){t.exports=n.p+"static/img/arrow-down.e9e55705.svg"},bbbe:function(t,e,n){t.exports=n.p+"static/img/icon-close.bf14d635.svg"},ce2b:function(t,e,n){"use strict";n("34b3")}}]);